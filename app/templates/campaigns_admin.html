{% extends "base.html" %}

{% block title %}Kampanijos ir bangos - TV Planner{% endblock %}

{% block content %}
<div
  data-pl-list="{{ url_for('campaigns.pl_list') }}"
  data-pl-owners-base="{{ url_for('campaigns.pl_owners', pl_id=0) }}"
  data-pl-targets-base="{{ url_for('campaigns.pl_targets', pl_id=0) }}"
  data-c-list="{{ url_for('campaigns.campaigns_list') }}"
  data-c-create="{{ url_for('campaigns.campaigns_create') }}"
  data-c-update-base="{{ url_for('campaigns.campaigns_update', cid=0) }}"
  data-c-delete-base="{{ url_for('campaigns.campaigns_delete', cid=0) }}"
  data-w-list-base="{{ url_for('campaigns.waves_list', cid=0) }}"
  data-w-create-base="{{ url_for('campaigns.waves_create', cid=0) }}"
  data-w-update-base="{{ url_for('campaigns.waves_update', wid=0) }}"
  data-w-delete-base="{{ url_for('campaigns.waves_delete', wid=0) }}"
  data-i-list-base="{{ url_for('campaigns.wave_items_list', wid=0) }}"
  data-i-create-base="{{ url_for('campaigns.wave_items_create', wid=0) }}"
  data-i-update-base="{{ url_for('campaigns.wave_items_update', iid=0) }}"
  data-i-delete-base="{{ url_for('campaigns.wave_items_delete', iid=0) }}"
  data-cd-list-base="{{ url_for('campaigns.get_campaign_discounts', cid=0) }}"
  data-cd-create-base="{{ url_for('campaigns.create_campaign_discount', cid=0) }}"
  data-wd-list-base="{{ url_for('campaigns.get_wave_discounts', wid=0) }}"
  data-wd-create-base="{{ url_for('campaigns.create_wave_discount', wid=0) }}"
  data-d-update-base="{{ url_for('campaigns.update_discount', did=0) }}"
  data-d-delete-base="{{ url_for('campaigns.delete_discount', did=0) }}"
  data-w-total-base="{{ url_for('campaigns.get_wave_total', wid=0) }}"
  data-c-status-base="{{ url_for('campaigns.update_campaign_status', cid=0) }}"
  data-tvc-list-base="{{ url_for('campaigns.list_tvcs', cid=0) }}"
  data-tvc-create-base="{{ url_for('campaigns.create_tvc', cid=0) }}"
  data-tvc-update-base="{{ url_for('campaigns.update_tvc', tvc_id=0) }}"
  data-tvc-delete-base="{{ url_for('campaigns.delete_tvc', tvc_id=0) }}"
>
  
  <!-- Page Header -->
  <div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-900">Kampanijos ir bangos</h1>
    <p class="mt-1 text-sm text-gray-600">Valdykite televizijos kampanijas, bangas ir TVC</p>
  </div>

  <div class="space-y-8">
    <!-- Campaigns -->
    <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Kampanijos</h2>
      <div class="grid grid-cols-1 lg:grid-cols-6 xl:grid-cols-8 gap-4 items-end">
        <div class="lg:col-span-2">
          <label class="block text-sm text-slate-600 mb-1">Pavadinimas</label>
          <input id="cName" class="w-full rounded-lg border-slate-300 px-3 py-2 text-sm">
        </div>
        <div class="lg:col-span-2">
          <label class="block text-sm text-slate-600 mb-1">Kainoraštis</label>
          <select id="cPL" class="w-full rounded-lg border-slate-300 px-3 py-2 text-sm"></select>
        </div>
        <div class="lg:col-span-2 xl:col-span-3">
          <label class="block text-sm text-slate-600 mb-1">Laikotarpis</label>
          <div class="grid grid-cols-2 gap-2">
            <input id="cStart" type="date" class="w-full rounded-lg border-slate-300 px-3 py-2 text-sm">
            <input id="cEnd" type="date" class="w-full rounded-lg border-slate-300 px-3 py-2 text-sm">
          </div>
        </div>
        <div class="xl:col-span-1">
          <button id="cCreate" class="px-4 py-2 text-sm rounded-lg bg-brand-600 hover:bg-brand-700 text-white font-medium transition-colors w-full">Sukurti</button>
        </div>
      </div>

      <div class="overflow-x-auto mt-4">
        <table class="min-w-full text-sm">
          <thead class="bg-slate-50 text-slate-700 border-b border-slate-200">
            <tr>
              <th class="text-left font-medium px-4 py-2">#</th>
              <th class="text-left font-medium px-4 py-2">Pavadinimas</th>
              <th class="text-left font-medium px-4 py-2">Kainoraštis</th>
              <th class="text-left font-medium px-4 py-2">Laikotarpis</th>
              <th class="text-left font-medium px-4 py-2">Statusas</th>
              <th class="text-left font-medium px-4 py-2 w-40">Veiksmai</th>
            </tr>
          </thead>
          <tbody id="cTbody" class="divide-y divide-slate-100"></tbody>
        </table>
      </div>
    </section>

    <!-- Waves + Items -->
    <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Bangos</h2>
      <div id="wavePanel" class="hidden">
        <!-- TVC Management -->
        <div class="mb-6 p-4 bg-slate-50 rounded-lg">
          <h3 class="font-medium text-slate-700 mb-3">TVC valdymas</h3>
          <div class="flex items-end gap-3 mb-3">
            <div>
              <label class="block text-sm text-slate-600 mb-1">TVC pavadinimas</label>
              <input id="tvcName" class="rounded-lg border-slate-300 px-3 py-2 text-sm w-48" placeholder="pvz. Vasaros akcija">
            </div>
            <div>
              <label class="block text-sm text-slate-600 mb-1">Trukmė (sek.)</label>
              <input id="tvcDuration" type="number" min="1" max="300" class="rounded-lg border-slate-300 px-3 py-2 text-sm w-24" placeholder="30">
            </div>
            <button id="tvcAdd" class="px-3 py-2 text-sm rounded-lg border border-emerald-300 bg-emerald-50 text-emerald-700 hover:bg-emerald-100">Pridėti TVC</button>
          </div>
          <div id="tvcList" class="space-y-2"></div>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-4 xl:grid-cols-6 gap-4 items-end mb-4">
          <div class="lg:col-span-2">
            <label class="block text-sm text-slate-600 mb-1">Bangos pavadinimas</label>
            <input id="wName" class="w-full rounded-lg border-slate-300 px-3 py-2 text-sm">
          </div>
          <div class="lg:col-span-2 xl:col-span-3">
            <label class="block text-sm text-slate-600 mb-1">Laikotarpis</label>
            <div class="grid grid-cols-2 gap-2">
              <input id="wStart" type="date" class="w-full rounded-lg border-slate-300 px-3 py-2 text-sm">
              <input id="wEnd" type="date" class="w-full rounded-lg border-slate-300 px-3 py-2 text-sm">
            </div>
          </div>
          <div class="xl:col-span-1">
            <button id="wAdd" class="px-4 py-2 text-sm rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white font-medium transition-colors w-full">Pridėti bangą</button>
          </div>
        </div>

        <div id="waves"></div>
      </div>
      <p id="noCampaign" class="text-slate-500">Pasirinkite arba sukurkite kampaniją.</p>
    </section>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script defer src="{{ url_for('static', filename='js/campaigns_admin.js') }}?v=2"></script>
{% endblock %}
